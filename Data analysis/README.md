# Data analysis

## Role

This folder contains the scripts and configurations necessary to analyze the skin injuries and data generated by the "Automated video analysis" module. It provides tools for statistical analysis (LMM), data processing, and visualization.

## Overview

This module focuses on the extraction and/or analysis of sow behavior data, including agonistic interactions (fighting, fleeing, displacement), movement, section occupancy, and skin injuries. It provides scripts for statistical analysis, data processing, and visualization to derive insights from tracking data. The module uses tracking data to quantify different behaviours of sows and find patterns.

## File Structure and Details

```
Data analysis/
├── completeHours.json
├── Displacement/
│   ├── displacement.py
│   ├── displacementAnalysis.py
│   ├── displacementBehavior.sh
│   └── displacementLMM.py
├── experiments.conf
├── Fighting/
│   ├── fighting.py
│   ├── fightingAnalysis.py
│   ├── fightingBehavior.sh
│   └── fightingLMM.py
├── fileParser.py
├── Fleeing/
│   ├── fleeing.py
│   ├── fleeingAnalysis.py
│   ├── fleeingBehavior.sh
│   └── fleeingLMM.py
├── missingAnimals.json
├── Movement/
│   ├── movement.py
│   ├── movementAnalysis.py
│   ├── movementExperiment2.sh
│   ├── movementExperiment3.sh
│   ├── movementExperiment4.sh
│   ├── movementExperiment5.sh
│   ├── movementExperiment6.sh
│   ├── movementExperiment7.sh
│   ├── movementExperiment8.sh
│   ├── movementExperiment9.sh
│   └── movementLMM.py
├── Output/
│   ├── displacement/
│   │   └── Experiment[2-7,9,Remux8]/
│   │       └── [0,2,7,9]_[2,7,9,17].csv
│   ├── fighting/
│   │   └── Experiment[2-7,9,Remux8]/
│   │       ├── [0,2,7,9]_[2,7,9,17].csv
│   │       ├── [0,2,7,9]_[2,7,9,17].txt
│   │       └── analysis/
│   │           ├── circlingBehaviourBarChart.png
│   │           ├── correlationAnalysis.txt
│   │           └── mergedFrame.csv
│   └── fleeing/
│   │   └── Experiment[2-7,9,Remux8]/
│   │       ├── [0,2,7,9]_[2,7,9,17].csv
│   │       └── [0,2,7,9]_[2,7,9,17].txt
│   └── movement/
│   │   └── Experiment[2-9,Remux8]/
│   │       ├── [0,2,7,9]_[2,7,9,17].txt
│   │       └── [0,2,7,9]_[17]_Naive.txt
│   └── occupancy/
│   │   └── Experiment[2-7,9,Remux8]/
│   │       ├── [0,2,7,9]_[2,7,9,17].png
│   │       ├── [0,2,7,9]_[2,7,9,17].txt
│   │       ├── [0,2,7,9]_[2,7,9,17]_Naive.png
│   │       └── [0,2,7,9]_[2,7,9,17]_Naive.txt
├── Plots/
│   ├── barPlotSectionOccupancy.py
│   ├── barPlotSkinInjuries.py
│   ├── boxPlotAgonistic.py
│   ├── boxplotMovement.py
│   ├── linePlotAgonistic.py
│   └── linePlotMovement.py
├── Section occupancy/
│   ├── sectionOccupance.py
│   └── sectionOccupancy.sh
├── Skin injuries/
│   ├── skinInjuriesLMM.py
│   └── WQSows.csv
└── treatment.conf
```

## Directory and File Details

### Configuration Files

-   `completeHours.json`: Stores a JSON object that lists the complete hourly track files for each experiment. The keys represent experiment IDs (e.g., "2"), and the values are lists of file paths to the track files that have complete 1h recordings.
-   `experiments.conf`: Configuration file that defines the start and end track files for each experiment. Each line specifies an experiment, and the paths to the start and end track files in JSON format.
-   `missingAnimals.json`: Stores a JSON object indicating which animals are missing from certain experiments. The keys represent experiment IDs, and the values are lists of animal IDs that are missing.
-   `treatment.conf`: Configuration file associating each experiment with a treatment group (e.g., P1, C1, etc.).

### Core Analysis Scripts

-   `fileParser.py`: Provides functions for parsing track file paths and collecting relevant files based on date and time criteria. Includes functions to collect all files, full files (ending with "0000/tracks.json"), and complete files based on `completeHours.json`.

### Agonistic Behavior Analysis

-   `Displacement/`: Contains scripts for analyzing displacement behavior.
    -   `displacement.py`: Main script for displacement analysis.
    -   `displacementAnalysis.py`: Script for performing specific analyses on displacement data.
    -   `displacementBehavior.sh`: Shell script to run displacement behavior analysis.
    -   `displacementLMM.py`: Script for Linear Mixed Model (LMM) analysis of displacement data.
-   `Fighting/`: Contains scripts for analyzing fighting behavior.
    -   `fighting.py`: Main script for fighting analysis.
    -   `fightingAnalysis.py`: Script for performing specific analyses on fighting data, including generating a circling behavior bar chart and correlation analysis.
    -   `fightingBehavior.sh`: Shell script to run fighting behavior analysis.
    -   `fightingLMM.py`: Script for LMM analysis of fighting data.
-   `Fleeing/`: Contains scripts for analyzing fleeing behavior.
    -   `fleeing.py`: Main script for fleeing analysis.
    -   `fleeingAnalysis.py`: Script for performing specific analyses on fleeing data.
    -   `fleeingBehavior.sh`: Shell script to run fleeing behavior analysis.
    -   `fleeingLMM.py`: Script for LMM analysis of fleeing data.

### Movement Analysis

-   `Movement/`: Contains scripts for analyzing movement patterns.
    -   `movement.py`: Main script for movement analysis.
    -   `movementAnalysis.py`: Script for performing specific analyses on movement data.
    -   `movementExperiment[2-9].sh`: Shell scripts to run movement analysis for different experiments.
    -   `movementLMM.py`: Script for LMM analysis of movement data.

### Section Occupancy Analysis

-   `Section occupancy/`: Contains scripts for analyzing section occupancy.
    -   `sectionOccupance.py`: Core script to calculate section occupancy.
    -   `sectionOccupancy.sh`: Shell script to run section occupancy analysis.

### Skin Injuries Analysis

-   `Skin injuries/`: Contains scripts for analyzing skin injuries.
    -   `skinInjuriesLMM.py`: Script for LMM analysis of skin injury data.
    -   `WQSows.csv`: CSV file containing data on skin injuries of sows, used for analysis based on Welfare Quality Protocol.

### Output Directory

-   `Output/`: Contains subdirectories for each output type (displacement, fighting, fleeing, movement, occupancy) and each experiment.
    -   `displacement/Experiment[2-7,9,Remux8]/[0,2,7,9]_[17].csv`: CSV files containing displacement data between sows, D0-D17.
    -   `fighting/Experiment[2-7,9,Remux8]/`:
        -   `[0,2,7,9]_[17].csv`: CSV files containing fighting data between sows, D0-D17.
        -   `[0,2,7,9]_[17].txt`: Text files, related to fighting data between sows, D0-D17.
        -   `analysis/`:
            -   `circlingBehaviourBarChart.png`: Bar chart visualizing circling behavior during fights.
            -   `correlationAnalysis.txt`: Text file containing correlation analysis results.
            -   `mergedFrame.csv`: CSV file containing merged frame data.
    -   `fleeing/Experiment[2-7,9,Remux8]/`:
        -   `[0,2,7,9]_[17].csv`: CSV files containing fleeing data between sows, D0-D17.
        -   `[0,2,7,9]_[17].txt`: Text files related to fleeing data between sows, D0-D17.
    -   `movement/Experiment[2-9,Remux8]/`:
        -   `[0,2,7,9]_[17].txt`: Text files containing movement data, D0-D17.
        -   `[0,2,7,9]_[17]_Naive.txt`: Text files containing naive movement data, D0-D17.
    -   `occupancy/Experiment[2-7,9,Remux8]/`:
        -   `[0,2,7,9]_[17].png`: PNG images visualizing occupancy, D0-D17.
        -   `[0,2,7,9]_[17].txt`: Text files containing occupancy data, D0-D17.
        -   `[0,2,7,9]_[17]_Naive.png`: PNG images visualizing naive occupancy, D0-D17.
        -   `[0,2,7,9]_[17]_Naive.txt`: Text files containing naive occupancy data, D0-D17.

### Plotting Scripts

-   `Plots/`: Contains scripts for generating various plots.
    -   `barPlotSectionOccupancy.py`: Script for creating bar plots of section occupancy data.
    -   `barPlotSkinInjuries.py`: Script for creating bar plots of skin injury data.
    -   `boxPlotAgonistic.py`: Script for generating box plots of agonistic behaviors.
    -   `boxplotMovement.py`: Script for generating box plots of movement data.
    -   `linePlotAgonistic.py`: Script for generating line plots of agonistic behaviors.
    -   `linePlotMovement.py`: Script for generating line plots of movement data.